<!doctype html>
<html>
<head>
  <title>Checkout â€“ Refresh Elixir</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white">

<script>
/* ðŸ”§ CHANGE UPI ID ANYTIME HERE */
const UPI_ID = "nipurna05-3@oksbi";

/* ðŸ”§ APPS SCRIPT WEB APP URL */
const ORDER_API = "YOUR_APPS_SCRIPT_WEB_APP_URL";
</script>

<section class="max-w-xl mx-auto px-6 py-16">
  <h1 class="text-3xl font-bold mb-6">Checkout</h1>

  <div id="cartBox" class="mb-6"></div>
  <p class="text-lg mb-4">Total: â‚¹<span id="total">0</span></p>

  <input id="name" placeholder="Full Name"
    class="w-full p-2 mb-3 bg-neutral-800 rounded">

  <input id="phone" placeholder="Phone Number"
    class="w-full p-2 mb-3 bg-neutral-800 rounded">

  <input id="address" placeholder="Delivery Address"
    class="w-full p-2 mb-4 bg-neutral-800 rounded">

  <div class="text-sm text-white/70 mb-4">
    Pay via UPI: <b id="upi"></b>
  </div>

  <button onclick="placeOrder()"
    class="w-full bg-green-600 py-3 rounded hover:bg-green-700">
    Place Order
  </button>
</section>

<script>
const cart = JSON.parse(localStorage.getItem("cart") || "[]");
const cartBox = document.getElementById("cartBox");
const totalEl = document.getElementById("total");
document.getElementById("upi").innerText = UPI_ID;

let total = 0;

function renderCart() {
  cartBox.innerHTML = "";
  total = 0;

  cart.forEach((item, i) => {
    total += item.price * item.qty;

    cartBox.innerHTML += `
      <div class="border border-white/10 p-3 mb-2 rounded">
        <div class="font-semibold">
          ${item.name} (${item.ml}ml)
        </div>
        <div class="text-sm mt-1">
          â‚¹${item.price} Ã— ${item.qty}
        </div>
        <div class="mt-2 flex gap-2">
          <button onclick="changeQty(${i},1)"
            class="px-2 bg-neutral-700 rounded">+</button>
          <button onclick="changeQty(${i},-1)"
            class="px-2 bg-neutral-700 rounded">âˆ’</button>
        </div>
      </div>
    `;
  });

  totalEl.innerText = total;
}

function changeQty(index, diff) {
  cart[index].qty += diff;
  if (cart[index].qty <= 0) {
    cart.splice(index, 1);
  }
  localStorage.setItem("cart", JSON.stringify(cart));
  renderCart();
}

async function placeOrder() {
  if (!cart.length) return alert("Cart is empty");

  const payload = {
    name: name.value,
    phone: phone.value,
    address: address.value,
    items: cart,
    total: total,
    status: "PENDING"
  };

  await fetch(ORDER_API, {
    method: "POST",
    body: JSON.stringify(payload)
  });

  localStorage.removeItem("cart");
  alert("Order placed. Please pay via UPI and wait for confirmation SMS.");
}

renderCart();
</script>

</body>
</html>
