<!doctype html>
<html>
<head>
  <title>Checkout</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white">

<script>
const UPI_ID = "nipurna05-3@oksbi";
const MERCHANT = "Refresh Elixir";
const ORDER_API = "YOUR_APPS_SCRIPT_WEB_APP_URL";

function upiLink(amount) {
  return `upi://pay?pa=${encodeURIComponent(UPI_ID)}&pn=${encodeURIComponent(MERCHANT)}&am=${amount}&cu=INR`;
}
</script>

<section class="max-w-xl mx-auto px-6 py-16">
  <h1 class="text-3xl mb-6">Checkout</h1>

  <div id="cart"></div>
  <p class="mt-4 text-lg">Total: ₹<span id="total"></span></p>

  <input id="name" placeholder="Name"
    class="w-full p-2 mt-4 bg-neutral-800 rounded">
  <input id="phone" placeholder="Phone"
    class="w-full p-2 mt-3 bg-neutral-800 rounded">
  <input id="address" placeholder="Address"
    class="w-full p-2 mt-3 bg-neutral-800 rounded">

  <button onclick="placeOrder()"
    class="w-full mt-6 bg-green-600 py-3 rounded">
    Place Order
  </button>
</section>

<script>
const cart = JSON.parse(localStorage.getItem("cart") || "[]");
const cartDiv = document.getElementById("cart");
let total = 0;

cart.forEach((i) => {
  total += i.price * i.qty;
  cartDiv.innerHTML += `
    <div class="border border-white/10 p-3 mb-2">
      ${i.name} (${i.ml}ml) × ${i.qty}
    </div>`;
});

document.getElementById("total").innerText = total;

async function placeOrder() {
  await fetch(ORDER_API, {
    method: "POST",
    body: JSON.stringify({
      name: name.value,
      phone: phone.value,
      address: address.value,
      items: cart,
      total,
      status: "PENDING"
    })
  });

  localStorage.removeItem("cart");
  window.location.href = upiLink(total);
}
</script>

</body>
</html>
