<!doctype html>
<html>
<head>
  <title>Explore Collection – Refresh Elixir</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white">

<header class="max-w-6xl mx-auto px-6 py-12">
  <h1 class="text-4xl font-bold">Explore Collection</h1>
  <input id="searchInput"
    placeholder="Search perfume..."
    class="mt-6 w-full md:w-1/2 p-2 bg-neutral-800 rounded">
</header>

<section class="max-w-6xl mx-auto px-6 pb-20">
  <div id="grid"
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8">
  </div>
</section>

<script type="module">
import { PERFUMES } from "./perfumes.js";
import { SIZES } from "./data.js";

/* ====== SAME CART LOGIC ====== */
function addToCart(product, size) {
  let cart = JSON.parse(localStorage.getItem("cart") || "[]");

  const existing = cart.find(
    i => i.id === product.id && i.size === size.ml
  );

  if (existing) {
    existing.qty += 1;
  } else {
    cart.push({
      id: product.id,
      name: product.name,
      size: size.ml,
      price: size.price,
      qty: 1
    });
  }

  localStorage.setItem("cart", JSON.stringify(cart));
}

function render() {
  const q = searchInput.value.toLowerCase();
  grid.innerHTML = "";

  PERFUMES
    .filter(p => p.name.toLowerCase().includes(q))
    .forEach(p => {
      let size = SIZES[0];

      const card = document.createElement("div");
      card.className = "border border-white/10 p-5 rounded-xl";

      card.innerHTML = `
        <img src="${size.image}" class="h-40 mx-auto mb-4">
        <h3 class="font-semibold">${p.name}</h3>
        <p class="text-sm text-white/60">${p.scentProfile}</p>

        <select class="mt-3 w-full bg-black border p-2">
          ${SIZES.map(s =>
            `<option value="${s.ml}">${s.ml}ml — ₹${s.price}</option>`
          ).join("")}
        </select>

        <button class="mt-4 w-full bg-pink-600 py-2 rounded">
          Add to Cart
        </button>
      `;

      const img = card.querySelector("img");
      const sel = card.querySelector("select");

      sel.onchange = () => {
        size = SIZES.find(s => s.ml == sel.value);
        img.src = size.image;
      };

      card.querySelector("button").onclick = () => {
        addToCart(p, size);
        alert("Added to cart");
      };

      grid.appendChild(card);
    });
}

searchInput.oninput = render;
render();
</script>

</body>
</html>
