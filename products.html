<!doctype html>
<html>
<head>
  <title>Explore Collection – Refresh Elixir</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white">

<header class="max-w-6xl mx-auto px-6 py-14 text-center">
  <h1 class="text-4xl font-bold">Explore Collection</h1>
  <p class="text-white/60 mt-3">Choose your fragrance & bottle size</p>
</header>

<section class="max-w-6xl mx-auto px-6 pb-20">
  <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8"></div>
</section>

<script type="module">
import { PRODUCTS, SIZES } from "./data.js";

const grid = document.getElementById("grid");

function addToCart(product, size) {
  const cart = JSON.parse(localStorage.getItem("cart") || "[]");
  const existing = cart.find(
    i => i.id === product.id && i.ml === size.ml
  );

  if (existing) {
    existing.qty++;
  } else {
    cart.push({
      id: product.id,
      name: product.name,
      ml: size.ml,
      price: size.price,
      qty: 1
    });
  }

  localStorage.setItem("cart", JSON.stringify(cart));
  window.location.href = "checkout.html";
}

PRODUCTS.forEach(product => {
  let selectedSize = SIZES[2]; // default 30ml

  const card = document.createElement("div");
  card.className = "border border-white/10 rounded-xl p-6";

  card.innerHTML = `
    <img src="${selectedSize.image}" class="h-44 mx-auto mb-4 transition">
    <h3 class="text-lg font-semibold">${product.name}</h3>

    <select class="mt-3 w-full bg-black border border-white/20 p-2 rounded">
      ${SIZES.map(s =>
        `<option value="${s.ml}">${s.ml}ml — ₹${s.price}</option>`
      ).join("")}
    </select>

    <button class="mt-4 w-full bg-pink-600 py-2 rounded hover:bg-pink-700">
      Add to Cart
    </button>
  `;

  const img = card.querySelector("img");
  const select = card.querySelector("select");
  const btn = card.querySelector("button");

  select.addEventListener("change", () => {
    selectedSize = SIZES.find(s => s.ml == select.value);
    img.src = selectedSize.image;
  });

  btn.addEventListener("click", () => addToCart(product, selectedSize));

  grid.appendChild(card);
});
</script>

</body>
</html>
