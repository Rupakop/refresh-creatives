<!doctype html>
<html>
<head>
  <title>Explore Collection</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black text-white">

<header class="text-center py-14">
  <h1 class="text-4xl font-bold">Explore Collection</h1>
</header>

<section class="max-w-6xl mx-auto px-6 pb-20">
  <div id="grid" class="grid grid-cols-1 md:grid-cols-3 gap-6"></div>
</section>

<script type="module">
import { PRODUCTS, SIZES } from "./data.js";

const grid = document.getElementById("grid");

function addToCart(p, size) {
  const cart = JSON.parse(localStorage.getItem("cart") || "[]");
  const found = cart.find(i => i.id === p.id && i.ml === size.ml);

  if (found) found.qty++;
  else cart.push({ id:p.id, name:p.name, ml:size.ml, price:size.price, qty:1 });

  localStorage.setItem("cart", JSON.stringify(cart));
  location.href = "checkout.html";
}

PRODUCTS.forEach(p => {
  let selectedSize = SIZES[0]; // 100ml DEFAULT

  const card = document.createElement("div");
  card.className = "border border-white/10 p-6 rounded";

  card.innerHTML = `
    <img src="${selectedSize.image}" class="h-40 mx-auto mb-4">
    <h3>${p.name}</h3>
    <select class="mt-2 w-full bg-black border p-2">
      ${SIZES.map(s =>
        `<option value="${s.ml}">${s.ml}ml — ₹${s.price}</option>`
      ).join("")}
    </select>
    <button class="mt-4 w-full bg-pink-600 py-2 rounded">Add to Cart</button>
  `;

  const img = card.querySelector("img");
  const sel = card.querySelector("select");

  sel.onchange = () => {
    selectedSize = SIZES.find(s => s.ml == sel.value);
    img.src = selectedSize.image;
  };

  card.querySelector("button").onclick = () => addToCart(p, selectedSize);
  grid.appendChild(card);
});
</script>

</body>
</html>
